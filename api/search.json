[{"id":"275c557dc611a51fdda7a7c7eb837734","title":"【探险家】题解","content":"题目背景\n我们的探险家捕获到了一段来自未知文明的神秘信号。经过初步分析，该文明使用一种基于大数模运算的加密方式来保护其通讯内容。幸运的是，你截获了两份使用不同密钥加密的相同信息。\n题目描述\n一段原始信息（一个整数 m）被两个不同的公共加密参数$k_1$和$k_2$分别处理，但都使用了同一个宇宙常数$C$作为模数。加密过程如下：$$s_1 \\equiv m^{k_1} \\pmod C \\s_2 \\equiv m^{k_2} \\pmod C$$\n作为首席密码分析师，你截获了两段加密后的信号$s_1$,$s_2$，以及对应的公共参数$k_1$,$k_2$和宇宙常数$C$。根据情报$k_1$和$k_2$互质。请利用这一关键信息，恢复出原始信息$m$。\n输入格式\n输入包含多组数据，第一行一个整数 $T$ 表示数据组数，保证 $1 \\le T\\le 10^4$ 。\n接下来$T$行，每行包含五个正整数 $s_1$，$s_2$，$k_1$，$k_2$，$C$，保证 $2^{8} &lt; C &lt; 2^{63}$，且 $C$ 有且只有两个质因子。\n输出格式\n对于每组数据，输出一行一个非负整数 $m$，代表恢复出的原始信息。请确保输出的 m 满足 $0≤m&lt;C$。答案保证 $m$ 与 $C$ 互质。\n样例\n输入 #11211502992813 2511821915 653507 57809 2638352023\n输出 #1119260817\n数据范围\n对于 $100% $的数据，$1≤T≤10$ $2^{8} &lt; C &lt; 2^{63}$$1\\le s_1, s_2 &lt; C$，$1\\le k_1, k_2 &lt; C$，$k_1$ 和 $k_2$ 互质，$m$ 和 $C$ 互质。\n思想事先声明，本人并无极强的注意力，仅仅够用而已。首先 $k_1$ 与 $k_2$ 互质，我们很容易想到拓展欧几里得算法，而题目又要求我们要求出 $m$，所以我们又很容易想到：$$k_1 x + k_2 y &#x3D; 1$$数据保证有解。\n然后因为一定有一个不为正整数，所以我们会想到求逆元。由于 $C$ 是有且只有两个质因子的正整数，所以只能再用拓展欧几里得算法求乘法逆元。\n然后求 $m^{k_1}$（或 $m^{k_1}$ 随便） 在模 $C$ 意义下的乘法逆元。然后拿代入一组使求乘法逆元的 $k$ 不为正整数的解。最后模下快速幂，然后相乘，最后取模。\nThen？Master it!\n代码1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;bits/stdc++.h&gt;using namespace std;using lint = __int128;using ll = long long;void exgcd(const ll&amp; a, const ll&amp; b, lint&amp; x, lint&amp; y)&#123;\tif (b == 0)\t&#123;\t\tx = 1;\t\ty = 0;\t\treturn;\t&#125;\texgcd(b, a % b, y, x);\ty -= (a / b) * x;&#125;inline ll qpow(lint x, ll k, const ll&amp; p)&#123;\tlint ans = 1;\twhile (k)\t&#123;\t\tif (k &amp; 1)\t\t\tans = (ans * x) % p;\t\tk &gt;&gt;= 1;\t\tx = (x * x) % p;\t&#125;\treturn ans;&#125;int main()&#123;\t\tios::sync_with_stdio(false);\t\tcin.tie(0);\t\tint t;\t\tcin &gt;&gt; t;\twhile (t --)\t&#123;\t\tll s1, s2, k1, k2, c;\t\tcin &gt;&gt; s1 &gt;&gt; s2 &gt;&gt; k1 &gt;&gt; k2 &gt;&gt; c;\t\tlint x, y, mul1, mul2, ul;\t\texgcd(k1, k2, x, y);\t\texgcd(s1, c, mul1, ul);\t\tlint nx = floor(double(-x) / k2);\t\tmul1 = (mul1 % c + c) % c;\t\tx = nx * k2 + x;\t\ty = y - nx * k1;\t\tmul1 = qpow(mul1, -x, c);\t\tmul2 = qpow(s2, y, c);\t\tcout &lt;&lt; ll(mul1 * mul2 % c) &lt;&lt; &#x27;\\n&#x27;;\t&#125;\treturn 0;&#125;\n","slug":"【探险家】题解","date":"2025-07-26T12:07:29.000Z","categories_index":"","tags_index":"数论,同余,拓展欧几里得","author_index":"Divinsword Liao"},{"id":"ba849c9b8f39cf0264d2f4a47f4f6665","title":"这是一篇水帖","content":"初来乍到，请多关照（其实就是水一帖）\n有什么想说的可以在本帖下面说a，说什么都可以a，博主也会时不时地看一下的。\n","slug":"这是一篇水帖","date":"2025-07-24T10:40:57.000Z","categories_index":"","tags_index":"聊天,介绍","author_index":"Divinsword Liao"},{"id":"b9663f58f18133b35bfe243f3e916a80","title":"Hello World","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\n快速上手新建一个帖子1$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\n运行服务器1$ hexo server\n\nMore info: Server\n创建静态文件1$ hexo generate\n\nMore info: Generating\n部署到远程站点1$ hexo deploy\n\nMore info: Deployment\n","slug":"hello-world","date":"2024-05-01T04:51:45.514Z","categories_index":"","tags_index":"","author_index":"Divinsword Liao"}]