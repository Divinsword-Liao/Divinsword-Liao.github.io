{"title":"【探险家】题解","uid":"275c557dc611a51fdda7a7c7eb837734","slug":"【探险家】题解","date":"2025-07-26T12:07:29.000Z","updated":"2025-07-26T16:08:52.830Z","comments":true,"path":"api/articles/【探险家】题解.json","keywords":null,"cover":null,"content":"<h2 id=\"题目背景\"><a href=\"#题目背景\" class=\"headerlink\" title=\"题目背景\"></a>题目背景</h2><hr>\n<p>我们的探险家捕获到了一段来自未知文明的神秘信号。经过初步分析，该文明使用一种基于大数模运算的加密方式来保护其通讯内容。幸运的是，你截获了两份使用不同密钥加密的相同信息。</p>\n<h2 id=\"题目描述\"><a href=\"#题目描述\" class=\"headerlink\" title=\"题目描述\"></a>题目描述</h2><hr>\n<p>一段原始信息（一个整数 m）被两个不同的公共加密参数$k_1$和$k_2$分别处理，但都使用了同一个宇宙常数$C$作为模数。加密过程如下：<br>$$s_1 \\equiv m^{k_1} \\pmod C \\<br>s_2 \\equiv m^{k_2} \\pmod C$$</p>\n<p>作为首席密码分析师，你截获了两段加密后的信号$s_1$,$s_2$，以及对应的公共参数$k_1$,$k_2$和宇宙常数$C$。根据情报$k_1$和$k_2$互质。请利用这一关键信息，恢复出原始信息$m$。</p>\n<h2 id=\"输入格式\"><a href=\"#输入格式\" class=\"headerlink\" title=\"输入格式\"></a>输入格式</h2><hr>\n<p>输入包含多组数据，第一行一个整数 $T$ 表示数据组数，保证 $1 \\le T\\le 10^4$ 。</p>\n<p>接下来$T$行，每行包含五个正整数 $s_1$，$s_2$，$k_1$，$k_2$，$C$，保证 $2^{8} &lt; C &lt; 2^{63}$，且 $C$ 有且只有两个质因子。</p>\n<h2 id=\"输出格式\"><a href=\"#输出格式\" class=\"headerlink\" title=\"输出格式\"></a>输出格式</h2><hr>\n<p>对于每组数据，输出一行一个非负整数 $m$，代表恢复出的原始信息。请确保输出的 m 满足 $0≤m&lt;C$。答案保证 $m$ 与 $C$ 互质。</p>\n<h2 id=\"样例\"><a href=\"#样例\" class=\"headerlink\" title=\"样例\"></a>样例</h2><hr>\n<h3 id=\"输入-1\"><a href=\"#输入-1\" class=\"headerlink\" title=\"输入 #1\"></a>输入 #1</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"number\">1502992813</span> <span class=\"number\">2511821915</span> <span class=\"number\">653507</span> <span class=\"number\">57809</span> <span class=\"number\">2638352023</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"输出-1\"><a href=\"#输出-1\" class=\"headerlink\" title=\"输出 #1\"></a>输出 #1</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">19260817</span><br></pre></td></tr></table></figure>\n<h2 id=\"数据范围\"><a href=\"#数据范围\" class=\"headerlink\" title=\"数据范围\"></a>数据范围</h2><hr>\n<p>对于 $100% $的数据，$1≤T≤10$ $2^{8} &lt; C &lt; 2^{63}$$1\\le s_1, s_2 &lt; C$，$1\\le k_1, k_2 &lt; C$，$k_1$ 和 $k_2$ 互质，$m$ 和 $C$ 互质。</p>\n<h1 id=\"思想\"><a href=\"#思想\" class=\"headerlink\" title=\"思想\"></a>思想</h1><h4 id=\"事先声明，本人并无极强的注意力，仅仅够用而已。\"><a href=\"#事先声明，本人并无极强的注意力，仅仅够用而已。\" class=\"headerlink\" title=\"事先声明，本人并无极强的注意力，仅仅够用而已。\"></a>事先声明，本人并无极强的注意力，仅仅够用而已。</h4><p>首先 $k_1$ 与 $k_2$ 互质，我们很容易想到拓展欧几里得算法，而题目又要求我们要求出 $m$，所以我们又很容易想到：$$k_1 x + k_2 y &#x3D; 1$$<br>数据保证有解。</p>\n<p>然后因为一定有一个不为正整数，所以我们会想到求逆元。由于 $C$ 是有且只有两个质因子的正整数，所以只能再用拓展欧几里得算法求乘法逆元。</p>\n<p>然后求 $m^{k_1}$（或 $m^{k_1}$ 随便） 在模 $C$ 意义下的乘法逆元。然后拿代入一组使求乘法逆元的 $k$ 不为正整数的解。最后模下快速幂，然后相乘，最后取模。</p>\n<p>Then？Master it!</p>\n<h1 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h1><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lint = __int128;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">exgcd</span><span class=\"params\">(<span class=\"type\">const</span> ll&amp; a, <span class=\"type\">const</span> ll&amp; b, lint&amp; x, lint&amp; y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (b == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tx = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\ty = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">exgcd</span>(b, a % b, y, x);</span><br><span class=\"line\">\ty -= (a / b) * x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> ll <span class=\"title\">qpow</span><span class=\"params\">(lint x, ll k, <span class=\"type\">const</span> ll&amp; p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tlint ans = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (k)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (k &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\tans = (ans * x) % p;</span><br><span class=\"line\">\t\tk &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tx = (x * x) % p;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t\tios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"literal\">false</span>);</span><br><span class=\"line\">\t\tcin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t<span class=\"type\">int</span> t;</span><br><span class=\"line\">\t\tcin &gt;&gt; t;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (t --)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tll s1, s2, k1, k2, c;</span><br><span class=\"line\">\t\tcin &gt;&gt; s1 &gt;&gt; s2 &gt;&gt; k1 &gt;&gt; k2 &gt;&gt; c;</span><br><span class=\"line\">\t\tlint x, y, mul1, mul2, ul;</span><br><span class=\"line\">\t\t<span class=\"built_in\">exgcd</span>(k1, k2, x, y);</span><br><span class=\"line\">\t\t<span class=\"built_in\">exgcd</span>(s1, c, mul1, ul);</span><br><span class=\"line\">\t\tlint nx = <span class=\"built_in\">floor</span>(<span class=\"built_in\">double</span>(-x) / k2);</span><br><span class=\"line\">\t\tmul1 = (mul1 % c + c) % c;</span><br><span class=\"line\">\t\tx = nx * k2 + x;</span><br><span class=\"line\">\t\ty = y - nx * k1;</span><br><span class=\"line\">\t\tmul1 = <span class=\"built_in\">qpow</span>(mul1, -x, c);</span><br><span class=\"line\">\t\tmul2 = <span class=\"built_in\">qpow</span>(s2, y, c);</span><br><span class=\"line\">\t\tcout &lt;&lt; <span class=\"built_in\">ll</span>(mul1 * mul2 % c) &lt;&lt; <span class=\"string\">&#x27;\\n&#x27;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","feature":true,"text":"题目背景 我们的探险家捕获到了一段来自未知文明的神秘信号。经过初步分析，该文明使用一种基于大数模运算的加密方式来保护其通讯内容。幸运的是，你截获了两份使用不同密...","permalink":"/post/【探险家】题解","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"数论","slug":"数论","count":1,"path":"api/tags/数论.json"},{"name":"同余","slug":"同余","count":1,"path":"api/tags/同余.json"},{"name":"拓展欧几里得","slug":"拓展欧几里得","count":1,"path":"api/tags/拓展欧几里得.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE%E8%83%8C%E6%99%AF\"><span class=\"toc-text\">题目背景</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">题目描述</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">输入格式</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">输出格式</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A0%B7%E4%BE%8B\"><span class=\"toc-text\">样例</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BE%93%E5%85%A5-1\"><span class=\"toc-text\">输入 #1</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BE%93%E5%87%BA-1\"><span class=\"toc-text\">输出 #1</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E8%8C%83%E5%9B%B4\"><span class=\"toc-text\">数据范围</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%80%9D%E6%83%B3\"><span class=\"toc-text\">思想</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E4%BA%8B%E5%85%88%E5%A3%B0%E6%98%8E%EF%BC%8C%E6%9C%AC%E4%BA%BA%E5%B9%B6%E6%97%A0%E6%9E%81%E5%BC%BA%E7%9A%84%E6%B3%A8%E6%84%8F%E5%8A%9B%EF%BC%8C%E4%BB%85%E4%BB%85%E5%A4%9F%E7%94%A8%E8%80%8C%E5%B7%B2%E3%80%82\"><span class=\"toc-text\">事先声明，本人并无极强的注意力，仅仅够用而已。</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">代码</span></a>","author":{"name":"Divinsword Liao","slug":"blog-author","avatar":"https://cdn.luogu.com.cn/upload/image_hosting/kd4ydj94.png","link":"/","description":"Wise man say only the fools rush in.","socials":{"github":"https://github.com/Divinsword-Liao","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"luogu":{"icon":"/svg/luogu.svg","link":"https://www.luogu.com.cn/user/992080"}}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"这是一篇水帖","uid":"ba849c9b8f39cf0264d2f4a47f4f6665","slug":"这是一篇水帖","date":"2025-07-24T10:40:57.000Z","updated":"2025-07-24T10:44:32.931Z","comments":true,"path":"api/articles/这是一篇水帖.json","keywords":null,"cover":null,"text":"初来乍到，请多关照（其实就是水一帖） 有什么想说的可以在本帖下面说a，说什么都可以a，博主也会时不时地看一下的。 ","permalink":"/post/这是一篇水帖","photos":[],"count_time":{"symbolsCount":57,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"聊天","slug":"聊天","count":1,"path":"api/tags/聊天.json"},{"name":"介绍","slug":"介绍","count":1,"path":"api/tags/介绍.json"}],"author":{"name":"Divinsword Liao","slug":"blog-author","avatar":"https://cdn.luogu.com.cn/upload/image_hosting/kd4ydj94.png","link":"/","description":"Wise man say only the fools rush in.","socials":{"github":"https://github.com/Divinsword-Liao","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"luogu":{"icon":"/svg/luogu.svg","link":"https://www.luogu.com.cn/user/992080"}}}},"feature":true}}